{% extends "base.html" %}

{% block title %}Admin Panel{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <!-- Admin Header -->
    <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-900">âš¡ Admin Panel</h1>
        <p class="text-gray-600 mt-2">System configuration and management tools</p>
        
        <!-- Logout button -->
        <div class="mt-4">
            <a href="/admin/logout" class="text-sm text-red-600 hover:text-red-800 underline">
                ğŸšª Admin Logout
            </a>
        </div>
    </div>

    <!-- Configuration Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        <!-- Employee Management Card -->
        <div class="card hover-lift">
            <div class="p-6">
                <div class="flex items-center justify-center w-12 h-12 bg-green-100 rounded-lg mx-auto mb-4">
                    <span class="text-2xl">ğŸ‘¥</span>
                </div>
                <h3 class="text-lg font-semibold text-center text-gray-900 mb-2">Employee Management</h3>
                <p class="text-sm text-gray-600 text-center mb-4">Add and manage employee accounts</p>
                <a href="/admin/employees" 
                   class="block w-full text-center btn-primary text-sm py-2">
                    ğŸ‘¥ Manage Employees
                </a>
            </div>
        </div>
        
        <!-- Product Configuration Card -->
        <div class="card hover-lift">
            <div class="p-6">
                <div class="flex items-center justify-center w-12 h-12 bg-orange-100 rounded-lg mx-auto mb-4">
                    <span class="text-2xl">ğŸ“Š</span>
                </div>
                <h3 class="text-lg font-semibold text-center text-gray-900 mb-2">Product Configuration</h3>
                <p class="text-sm text-gray-600 text-center mb-4">Manage tablet types, products, and calculations</p>
                <div class="space-y-2">
                    <a href="/admin/tablet_types" 
                       class="block w-full text-center btn-secondary text-sm py-2">
                        ğŸ§ª Tablet Types & IDs
                    </a>
                    <a href="/admin/products" 
                       class="block w-full text-center btn-warning text-sm py-2">
                        ğŸ“ Product Config
                    </a>
                </div>
            </div>
        </div>

        <!-- Shipments Card -->
        <div class="card hover-lift">
            <div class="p-6">
                <div class="flex items-center justify-center w-12 h-12 bg-blue-100 rounded-lg mx-auto mb-4">
                    <span class="text-2xl">ğŸšš</span>
                </div>
                <h3 class="text-lg font-semibold text-center text-gray-900 mb-2">Shipments</h3>
                <p class="text-sm text-gray-600 text-center mb-4">Track vendor shipments</p>
                <a href="/admin/shipments" 
                   class="block w-full text-center btn-success text-sm py-2">
                    Manage Shipments
                </a>
            </div>
        </div>
    </div>

    <!-- System Tools -->
    <div class="card p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4 text-center">ğŸ”§ System Tools</h3>
        <div class="flex justify-center space-x-4">
            <button onclick="testZohoConnection()" 
                    class="btn-primary">
                ğŸ”Œ Test Zoho Connection
            </button>
            <a href="/dashboard" class="btn-secondary">
                ğŸ“ˆ View Dashboard
            </a>
        </div>
    </div>
</div>

<!-- Status Messages -->
<div id="admin-messages" class="mt-6"></div>

<script>
// Admin panel functions

async function testZohoConnection() {
    const button = event.target;
    const originalText = button.textContent;
    
    try {
        button.disabled = true;
        button.textContent = 'ğŸ”Œ Testing Connection...';
        
        const response = await fetch('/api/test_zoho_connection');
        const result = await response.json();
        
        if (result.success) {
            showSuccess('âœ… Connection successful!');
        } else {
            showError('âŒ Connection failed: ' + result.error);
        }
        
        button.disabled = false;
        button.textContent = originalText;
    } catch (error) {
        showError('Connection test failed: ' + error.message);
        button.disabled = false;
        button.textContent = originalText;
    }
}









function showSuccess(message) {
    showMessage(message, 'success');
}

function showError(message) {
    showMessage(message, 'error');
}

function showMessage(message, type) {
    const container = document.getElementById('admin-messages');
    const alertClass = type === 'success' ? 'bg-green-100 border-green-500 text-green-700' : 'bg-red-100 border-red-500 text-red-700';
    
    const alert = document.createElement('div');
    alert.className = `border-l-4 p-4 rounded ${alertClass} mb-4`;
    alert.innerHTML = `
        <div class="flex">
            <div class="flex-shrink-0">
                <span class="text-lg">${type === 'success' ? 'âœ…' : 'âŒ'}</span>
            </div>
            <div class="ml-3">
                <p class="text-sm">${message}</p>
            </div>
        </div>
    `;
    
    container.appendChild(alert);
    
    // Auto remove after 5 seconds
    setTimeout(() => {
        alert.remove();
    }, 5000);
}
</script>
{% endblock %}
